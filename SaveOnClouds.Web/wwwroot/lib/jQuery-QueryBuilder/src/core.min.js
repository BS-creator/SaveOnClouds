/**
 * Minified by jsDelivr using Terser v3.14.1.
 * Original file: /npm/jQuery-QueryBuilder@2.5.2/src/core.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
QueryBuilder.prototype.init=function(e){this.trigger("afterInit"),e?(this.setRules(e),delete this.settings.rules):this.setRoot(!0)},QueryBuilder.prototype.checkFilters=function(e){var t=[];if(e&&0!==e.length||Utils.error("Config","Missing filters list"),e.forEach(function(e,r){switch(e.id||Utils.error("Config","Missing filter {0} id",r),-1!=t.indexOf(e.id)&&Utils.error("Config",'Filter "{0}" already defined',e.id),t.push(e.id),e.type?QueryBuilder.types[e.type]||Utils.error("Config",'Invalid type "{0}"',e.type):e.type="string",e.input?"function"!=typeof e.input&&-1==QueryBuilder.inputs.indexOf(e.input)&&Utils.error("Config",'Invalid input "{0}"',e.input):e.input="number"===QueryBuilder.types[e.type]?"number":"text",e.operators&&e.operators.forEach(function(e){"string"!=typeof e&&Utils.error("Config","Filter operators must be global operators types (string)")}),e.field||(e.field=e.id),e.label||(e.label=e.field),e.optgroup?(this.status.has_optgroup=!0,this.settings.optgroups[e.optgroup]||(this.settings.optgroups[e.optgroup]=e.optgroup)):e.optgroup=null,e.input){case"radio":case"checkbox":(!e.values||e.values.length<1)&&Utils.error("Config",'Missing filter "{0}" values',e.id);break;case"select":var i=[];e.has_optgroup=!1,Utils.iterateOptions(e.values,function(t,r,o){i.push({value:t,label:r,optgroup:o||null}),o&&(e.has_optgroup=!0,this.settings.optgroups[o]||(this.settings.optgroups[o]=o))}.bind(this)),e.has_optgroup?e.values=Utils.groupSort(i,"optgroup"):e.values=i,e.placeholder&&(void 0===e.placeholder_value&&(e.placeholder_value=-1),e.values.forEach(function(t){t.value==e.placeholder_value&&Utils.error("Config",'Placeholder of filter "{0}" overlaps with one of its values',e.id)}))}},this),this.settings.sort_filters)if("function"==typeof this.settings.sort_filters)e.sort(this.settings.sort_filters);else{var r=this;e.sort(function(e,t){return r.translate(e.label).localeCompare(r.translate(t.label))})}return this.status.has_optgroup&&(e=Utils.groupSort(e,"optgroup")),e},QueryBuilder.prototype.checkOperators=function(e){var t=[];return e.forEach(function(r,i){"string"==typeof r?(QueryBuilder.OPERATORS[r]||Utils.error("Config",'Unknown operator "{0}"',r),e[i]=r=$.extendext(!0,"replace",{},QueryBuilder.OPERATORS[r])):(r.type||Utils.error("Config",'Missing "type" for operator {0}',i),QueryBuilder.OPERATORS[r.type]&&(e[i]=r=$.extendext(!0,"replace",{},QueryBuilder.OPERATORS[r.type],r)),void 0!==r.nb_inputs&&void 0!==r.apply_to||Utils.error("Config",'Missing "nb_inputs" and/or "apply_to" for operator "{0}"',r.type)),-1!=t.indexOf(r.type)&&Utils.error("Config",'Operator "{0}" already defined',r.type),t.push(r.type),r.optgroup?(this.status.has_operator_optgroup=!0,this.settings.optgroups[r.optgroup]||(this.settings.optgroups[r.optgroup]=r.optgroup)):r.optgroup=null},this),this.status.has_operator_optgroup&&(e=Utils.groupSort(e,"optgroup")),e},QueryBuilder.prototype.bindEvents=function(){var e=this,t=QueryBuilder.selectors;this.$el.on("change.queryBuilder",t.group_condition,function(){if($(this).is(":checked")){var r=$(this).closest(t.group_container);e.getModel(r).condition=$(this).val()}}),this.$el.on("change.queryBuilder",t.rule_filter,function(){var r=$(this).closest(t.rule_container);e.getModel(r).filter=e.getFilterById($(this).val())}),this.$el.on("change.queryBuilder",t.rule_operator,function(){var r=$(this).closest(t.rule_container);e.getModel(r).operator=e.getOperatorByType($(this).val())}),this.$el.on("click.queryBuilder",t.add_rule,function(){var r=$(this).closest(t.group_container);e.addRule(e.getModel(r))}),this.$el.on("click.queryBuilder",t.delete_rule,function(){var r=$(this).closest(t.rule_container);e.deleteRule(e.getModel(r))}),0!==this.settings.allow_groups&&(this.$el.on("click.queryBuilder",t.add_group,function(){var r=$(this).closest(t.group_container);e.addGroup(e.getModel(r))}),this.$el.on("click.queryBuilder",t.delete_group,function(){var r=$(this).closest(t.group_container);e.deleteGroup(e.getModel(r))})),this.model.on({drop:function(t,r){r.$el.remove(),e.refreshGroupsConditions()},add:function(t,r,i,o){0===o?i.$el.prependTo(r.$el.find(">"+QueryBuilder.selectors.rules_list)):i.$el.insertAfter(r.rules[o-1].$el),e.refreshGroupsConditions()},move:function(t,r,i,o){r.$el.detach(),0===o?r.$el.prependTo(i.$el.find(">"+QueryBuilder.selectors.rules_list)):r.$el.insertAfter(i.rules[o-1].$el),e.refreshGroupsConditions()},update:function(t,r,i,o,l){if(r instanceof Rule)switch(i){case"error":e.updateError(r);break;case"flags":e.applyRuleFlags(r);break;case"filter":e.updateRuleFilter(r,l);break;case"operator":e.updateRuleOperator(r,l);break;case"value":e.updateRuleValue(r,l)}else switch(i){case"error":e.updateError(r);break;case"flags":e.applyGroupFlags(r);break;case"condition":e.updateGroupCondition(r,l)}}})},QueryBuilder.prototype.setRoot=function(e,t,r){e=void 0===e||!0===e;var i=this.nextGroupId(),o=$(this.getGroupTemplate(i,1));return this.$el.append(o),this.model.root=new Group(null,o),this.model.root.model=this.model,this.model.root.data=t,this.model.root.flags=$.extend({},this.settings.default_group_flags,r),this.model.root.condition=this.settings.default_condition,this.trigger("afterAddGroup",this.model.root),e&&this.addRule(this.model.root),this.model.root},QueryBuilder.prototype.addGroup=function(e,t,r,i){t=void 0===t||!0===t;var o=e.level+1;if(this.trigger("beforeAddGroup",e,t,o).isDefaultPrevented())return null;var l=this.nextGroupId(),s=$(this.getGroupTemplate(l,o)),u=e.addGroup(s);return u.data=r,u.flags=$.extend({},this.settings.default_group_flags,i),u.condition=this.settings.default_condition,this.trigger("afterAddGroup",u),this.trigger("rulesChanged"),t&&this.addRule(u),u},QueryBuilder.prototype.deleteGroup=function(e){if(e.isRoot())return!1;if(this.trigger("beforeDeleteGroup",e).isDefaultPrevented())return!1;var t=!0;return e.each("reverse",function(e){t&=this.deleteRule(e)},function(e){t&=this.deleteGroup(e)},this),t&&(e.drop(),this.trigger("afterDeleteGroup"),this.trigger("rulesChanged")),t},QueryBuilder.prototype.updateGroupCondition=function(e,t){e.$el.find(">"+QueryBuilder.selectors.group_condition).each(function(){var t=$(this);t.prop("checked",t.val()===e.condition),t.parent().toggleClass("active",t.val()===e.condition)}),this.trigger("afterUpdateGroupCondition",e,t),this.trigger("rulesChanged")},QueryBuilder.prototype.refreshGroupsConditions=function(){!function e(t){(!t.flags||t.flags&&!t.flags.condition_readonly)&&t.$el.find(">"+QueryBuilder.selectors.group_condition).prop("disabled",t.rules.length<=1).parent().toggleClass("disabled",t.rules.length<=1),t.each(null,function(t){e(t)},this)}(this.model.root)},QueryBuilder.prototype.addRule=function(e,t,r){if(this.trigger("beforeAddRule",e).isDefaultPrevented())return null;var i=this.nextRuleId(),o=$(this.getRuleTemplate(i)),l=e.addRule(o);return l.data=t,l.flags=$.extend({},this.settings.default_rule_flags,r),this.trigger("afterAddRule",l),this.trigger("rulesChanged"),this.createRuleFilters(l),!this.settings.default_filter&&this.settings.display_empty_filter||(l.filter=this.change("getDefaultFilter",this.getFilterById(this.settings.default_filter||this.filters[0].id),l)),l},QueryBuilder.prototype.deleteRule=function(e){return!e.flags.no_delete&&(!this.trigger("beforeDeleteRule",e).isDefaultPrevented()&&(e.drop(),this.trigger("afterDeleteRule"),this.trigger("rulesChanged"),!0))},QueryBuilder.prototype.createRuleFilters=function(e){var t=this.change("getRuleFilters",this.filters,e),r=$(this.getRuleFilterSelect(e,t));e.$el.find(QueryBuilder.selectors.filter_container).html(r),this.trigger("afterCreateRuleFilters",e),this.applyRuleFlags(e)},QueryBuilder.prototype.createRuleOperators=function(e){var t=e.$el.find(QueryBuilder.selectors.operator_container).empty();if(e.filter){var r=this.getOperators(e.filter),i=$(this.getRuleOperatorSelect(e,r));t.html(i),e.filter.default_operator?e.__.operator=this.getOperatorByType(e.filter.default_operator):e.__.operator=r[0],e.$el.find(QueryBuilder.selectors.rule_operator).val(e.operator.type),this.trigger("afterCreateRuleOperators",e,r),this.applyRuleFlags(e)}},QueryBuilder.prototype.createRuleInput=function(e){var t=e.$el.find(QueryBuilder.selectors.value_container).empty();if(e.__.value=void 0,e.filter&&e.operator&&0!==e.operator.nb_inputs){for(var r=this,i=$(),o=e.filter,l=0;l<e.operator.nb_inputs;l++){var s=$(this.getRuleInput(e,l));l>0&&t.append(this.settings.inputs_separator),t.append(s),i=i.add(s)}t.css("display",""),i.on("change "+(o.input_event||""),function(){e._updating_input||(e._updating_value=!0,e.value=r.getRuleInputValue(e),e._updating_value=!1)}),o.plugin&&i[o.plugin](o.plugin_config||{}),this.trigger("afterCreateRuleInput",e),void 0!==o.default_value?e.value=o.default_value:(e._updating_value=!0,e.value=r.getRuleInputValue(e),e._updating_value=!1),this.applyRuleFlags(e)}},QueryBuilder.prototype.updateRuleFilter=function(e,t){this.createRuleOperators(e),this.createRuleInput(e),e.$el.find(QueryBuilder.selectors.rule_filter).val(e.filter?e.filter.id:"-1"),t&&e.filter&&t.id!==e.filter.id&&(e.data=void 0),this.trigger("afterUpdateRuleFilter",e,t),this.trigger("rulesChanged")},QueryBuilder.prototype.updateRuleOperator=function(e,t){var r=e.$el.find(QueryBuilder.selectors.value_container);e.operator&&0!==e.operator.nb_inputs?(r.css("display",""),!r.is(":empty")&&t&&e.operator.nb_inputs===t.nb_inputs&&e.operator.optgroup===t.optgroup||this.createRuleInput(e)):(r.hide(),e.__.value=void 0),e.operator&&(e.$el.find(QueryBuilder.selectors.rule_operator).val(e.operator.type),e.__.value=this.getRuleInputValue(e)),this.trigger("afterUpdateRuleOperator",e,t),this.trigger("rulesChanged")},QueryBuilder.prototype.updateRuleValue=function(e,t){e._updating_value||this.setRuleInputValue(e,e.value),this.trigger("afterUpdateRuleValue",e,t),this.trigger("rulesChanged")},QueryBuilder.prototype.applyRuleFlags=function(e){var t=e.flags,r=QueryBuilder.selectors;e.$el.find(r.rule_filter).prop("disabled",t.filter_readonly),e.$el.find(r.rule_operator).prop("disabled",t.operator_readonly),e.$el.find(r.rule_value).prop("disabled",t.value_readonly),t.no_delete&&e.$el.find(r.delete_rule).remove(),this.trigger("afterApplyRuleFlags",e)},QueryBuilder.prototype.applyGroupFlags=function(e){var t=e.flags,r=QueryBuilder.selectors;e.$el.find(">"+r.group_condition).prop("disabled",t.condition_readonly).parent().toggleClass("readonly",t.condition_readonly),t.no_add_rule&&e.$el.find(r.add_rule).remove(),t.no_add_group&&e.$el.find(r.add_group).remove(),t.no_delete&&e.$el.find(r.delete_group).remove(),this.trigger("afterApplyGroupFlags",e)},QueryBuilder.prototype.clearErrors=function(e){(e=e||this.model.root)&&(e.error=null,e instanceof Group&&e.each(function(e){e.error=null},function(e){this.clearErrors(e)},this))},QueryBuilder.prototype.updateError=function(e){if(this.settings.display_errors)if(null===e.error)e.$el.removeClass("has-error");else{var t=this.translate("errors",e.error[0]);t=Utils.fmt(t,e.error.slice(1)),t=this.change("displayError",t,e.error,e),e.$el.addClass("has-error").find(QueryBuilder.selectors.error_container).eq(0).attr("title",t)}},QueryBuilder.prototype.triggerValidationError=function(e,t,r){$.isArray(t)||(t=[t]),this.trigger("validationError",e,t,r).isDefaultPrevented()||(e.error=t)};
//# sourceMappingURL=/sm/d4d30b1f6ed9fa7d7a53442b3f5b597883422efad685f2c393cc0333fc6ded97.map